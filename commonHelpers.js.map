{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export const renderGallery = (articleContainer, images) => {\n  const createMarkupPage = images.map(article => {\n    return `\n    <div class=\"photo-card\">\n        <a class =\"thumb\" href=\"${article.largeImageURL}\"><img class=\"img\" src=\"${article.webformatURL}\" alt=\"${article.tags}\" loading=\"lazy\" /> </a> \n      <div class=\"info\">\n        <p class=\"info-item\">\n          <b>Likes</b>\n          ${article.likes}\n        </p>\n        <p class=\"info-item\">\n          <b>Views</b>\n          ${article.views}\n        </p>\n        <p class=\"info-item\">\n          <b>Comments</b>\n          ${article.comments}\n        </p>\n        <p class=\"info-item\">\n          <b>Downloads</b>\n          ${article.downloads}\n        </p>\n      </div>\n    </div>\n  `;\n})\n.join('');\n\n   articleContainer.insertAdjacentHTML('beforeend', createMarkupPage);\n\n}","import axios from 'axios';\n\nconst API_KEY  = '31511712-b53d42f48d96ff6235f6befd4';\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nexport async function fetchArticles(value, currentPage) {\n  try {\n    const res = await axios.get(`?key=${API_KEY}&q=${value}&image_type=photo&orientation=horizontal&safesearch=true&page=${currentPage}&per_page=15`);\n    return res.data;\n  } catch (error) {\n    throw error;\n  }\n}\n\n// export async function fetchArticles(value, currentPage) {\n//   try {\n//     const res = await axios.get(`?key=${API_KEY}&q=${value}&image_type=photo&orientation=horizontal&safesearch=true&page=${currentPage}&per_page=15`);\n    \n//     // Проверяем, если количество изображений на сервере меньше 15\n//     const remainingImages = res.data.totalHits - (currentPage - 1) * 15;\n//     const imagesToFetch = Math.min(remainingImages, 15);\n    \n//     // Если осталось меньше 15 изображений, загружаем только их\n//     const finalRes = {\n//       ...res.data,\n//       hits: res.data.hits.slice(0, imagesToFetch)\n//     };\n    \n//     return finalRes;\n//   } catch (error) {\n//     throw error;\n//   }\n// }","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport { renderGallery } from \"./js/render-functions\"; \nimport { fetchArticles } from \"./js/pixabay-api\";\n\nconst articleContainer = document.querySelector('.gallery');\nconst loaderMarkup  = '<div id=\"loader\" class=\"loader\"></div>';\n\nconst searchForm = document.querySelector('.search-form');\nconst searchInputElement = document.querySelector('input[class=\"form-control\"]');\n\n\nlet photos = [];\nlet form = null;\nlet currentPage = 1;\nlet totalImages = 0;\n\nlet maxPageNumber = 0;\n\n\nconst lightbox = new SimpleLightbox('.gallery a');\n\n\nconst searchBtn = document.querySelector('.btn-submit');\nconst loadMoreBtn = document.querySelector('[data-action=\"load-more\"]');\n\n\n\nsearchForm.addEventListener('submit', handleFormSubmit);\n  \n  function handleFormSubmit(e) { \n    e.preventDefault();\n    resetPage();\n\n  form = (e.currentTarget.elements.searchQuery.value).trim();\n   if (form === null || form === '') {\n    iziToast.info({\n    title: 'Please type something in the search input',\n      position: 'topRight',\n    });\n   } else {\n     loadMoreBtn.style.display = 'none';\n     main(form)\n     searchForm.reset();\n  }\n\n  }\n\n\nsearchInputElement.addEventListener('input', () => {\n  const inputValue = searchInputElement.value.trim();\n  if (inputValue) {\n    searchBtn.disabled = false;\n  } else {\n    searchBtn.disabled = true;\n  }\n});\n\nasync function main(value) {\n  try {\n    articleContainer.insertAdjacentHTML(\"beforebegin\", loaderMarkup);\n    clearArticlesContainer();\n\n     \n\n    const images = await fetchArticles(value, currentPage);\n    if (images && images.hits.length > 0) {\n      photos = [...images.hits];\n      totalImages = images.totalHits;\n\n      maxPageNumber = Math.ceil(totalImages / 15);\n\n      removeLoaderSpinner();\n      renderGallery(articleContainer, photos);\n      loadMoreBtn.style.display = 'block';\n      searchBtn.disabled = true;\n    } else {\n      removeLoaderSpinner();\n      loadMoreBtn.style.display = 'none';\n      iziToast.error({\n        title: 'Sorry, there are no images matching your search query',\n        position: 'topRight',\n      });\n      clearArticlesContainer();\n    }\n    \n\n    lightbox.refresh();\n  } catch (error) {\n    console.log(error);\n  }\n}\n\n\nfunction removeLoaderSpinner() {\n  const loaderSpinner = document.querySelector('#loader');\n  if (loaderSpinner) {\n    loaderSpinner.remove();\n  }\n}\n\nloadMoreBtn.addEventListener('click', () => addCards(form));\n\n// async function addCards(form) {\n//   loadMoreBtn.insertAdjacentHTML(\"beforebegin\", loaderMarkup);\n//   incrementPage();\n\n//   try {\n    \n//   let maxPageNumber = totalImages / 15;\n//   let maxPageNumberRoundUp = Math.ceil(maxPageNumber);\n   \n//     const restPhoto = await fetchArticles(form, currentPage, perPage);\n//     photos = [...restPhoto.hits];\n\n//     if (currentPage === maxPageNumberRoundUp) {\n//       loadMoreBtn.style.display = 'none';\n//       iziToast.info({\n//         title: \"We're sorry, but you've reached the end of search results.\",\n//         position: 'topRight',\n//       });\n\n//     }\n\n//      if (totalImages < 15) { \n//         perPage = totalImages\n//         const restPhoto = await fetchArticles(form, currentPage, perPage);\n//         photos = [...restPhoto.hits];\n//        removeLoaderSpinner();\n//      }\n      \n//      removeLoaderSpinner();\n//      renderGallery(articleContainer, photos);\n//      scrollToElementHeight();\n//      lightbox.refresh();\n\n//   }\n//   } catch (error) {\n//     console.log(error)\n//   }\n// }\n\n// async function addCards(form) {\n//   loadMoreBtn.insertAdjacentHTML(\"beforebegin\", loaderMarkup);\n//   incrementPage();\n\n//   try {\n\n   \n//     const restPhoto = await fetchArticles(form, currentPage);\n//     photos = [...restPhoto.hits];\n\n//     if (currentPage === maxPageNumberRoundUp) {\n    \n     \n     \n//       const restPhoto = await fetchArticles(form, currentPage);\n//       photos = [...restPhoto.hits];\n//       removeLoaderSpinner();\n//       loadMoreBtn.style.display = 'none';\n\n//       iziToast.info({\n//         title: \"We're sorry, but you've reached the end of search results.\",\n//         position: 'topRight',\n//       });\n\n      \n\n//     }\n\n//     removeLoaderSpinner();\n//     renderGallery(articleContainer, photos);\n//     scrollToElementHeight();\n//     lightbox.refresh();\n//   } catch (error) {\n//     console.log(error);\n//   }\n// }\n\n\nasync function addCards(form) {\n  loadMoreBtn.insertAdjacentHTML(\"beforebegin\", loaderMarkup);\n  incrementPage();\n\n  try {\n    const restPhoto = await fetchArticles(form, currentPage);\n    photos = [...restPhoto.hits];\n\n    if (currentPage >= maxPageNumber) {\n      loadMoreBtn.style.display = 'none'; \n\n      iziToast.info({\n        title: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    }\n\n    removeLoaderSpinner();\n    renderGallery(articleContainer, photos);\n    scrollToElementHeight();\n    lightbox.refresh();\n  } catch (error) {\n    console.log(error);\n  }\n}\n\n\nfunction clearArticlesContainer() {\n  articleContainer.innerHTML = '';\n}\n\n\nfunction resetPage() {\n  currentPage = 1;\n} \n\nfunction incrementPage() {\n  currentPage += 1;\n}\n\n\nfunction scrollToDistance(distance) {\n  const delay = 500;\n  const scrollTimeout = setTimeout(() => {\n    window.scrollBy({\n      top: distance * 1.5,\n      left: 0,\n      behavior: 'smooth',\n    });\n    clearTimeout(scrollTimeout);\n  }, delay);\n};\n\nfunction scrollToElementHeight(){\n  const galleryItemElement = document.querySelector('.photo-card');\n  const galleryItemRect = galleryItemElement.getBoundingClientRect();\n  scrollToDistance(galleryItemRect.height);\n};\n\n\n\n\n"],"names":["renderGallery","articleContainer","images","createMarkupPage","article","API_KEY","axios","fetchArticles","value","currentPage","error","loaderMarkup","searchForm","searchInputElement","photos","form","totalImages","maxPageNumber","lightbox","SimpleLightbox","searchBtn","loadMoreBtn","handleFormSubmit","e","resetPage","iziToast","main","clearArticlesContainer","removeLoaderSpinner","loaderSpinner","addCards","incrementPage","scrollToElementHeight","scrollToDistance","distance","scrollTimeout","galleryItemRect"],"mappings":"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"}